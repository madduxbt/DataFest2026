---
title: "Lecture 02: Exploring Data Frames in R"
author: "Bao Maddux"
date: "2026-01-26"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Introduction

In this lecture, we will learn how to work with data frames, which are the most common data structure for storing datasets in R. A data frame is essentially a table where each column represents a variable and each row represents an observation. Think of it like a spreadsheet in Excel, but with much more powerful capabilities for analysis.

# Importing Data into R

## Setting Your Working Directory

Prior to importing data, it is necessary to specify the file path from which R will read data files. This location is referred to as the **working directory**. Properly configuring the working directory is essential importing data files.

### Checking Your Current Working Directory

To see your current working directory, use:

```{r}
getwd()
```

### Setting the Working Directory on Windows

On Windows, file paths use backslashes (`\`), but R requires either forward slashes (`/`) or double backslashes (`\\`).

**Method 1: Using `setwd()` with forward slashes**
```{r, eval=FALSE}
setwd("C:/Users/YourUsername/Documents/R_Course")
```

**Method 2: Using `setwd()` with double backslashes**
```{r, eval=FALSE}
setwd("C:\\Users\\YourUsername\\Documents\\R_Course")
```

**Method 3: Using RStudio's menu**

1. Go to **Session** → **Set Working Directory** → **Choose Directory...**
2. Navigate to your desired folder
3. Click **Select Folder**

### Setting the Working Directory on Mac

On Mac, file paths use forward slashes (`/`), which is the same format R expects.

**Method 1: Using `setwd()`**
```{r, eval=FALSE}
setwd("/Users/YourUsername/Documents/R_Course")
```

**Method 2: Using the tilde shortcut for home directory**
```{r, eval=FALSE}
setwd("~/Documents/R_Course")
```

**Method 3: Using RStudio's menu**

1. Go to **Session** → **Set Working Directory** → **Choose Directory...**
2. Navigate to your desired folder
3. Click **Open**

## Importing a CSV File

CSV (Comma-Separated Values) files are one of the most common formats for storing tabular data. To import a CSV file, we use the `read.csv()` function.

```{r, eval=FALSE}
# Basic syntax
my_data = read.csv("filename.csv")
```

For this lecture, we will use the built-in `mtcars` dataset and save it as a CSV to demonstrate the import process:

```{r, eval = TRUE}
# First, let's save mtcars as a CSV file for demonstration
write.csv(mtcars, "mtcars_example.csv", row.names = TRUE)

# Now import it back
car_data = read.csv("mtcars_example.csv")
```

### Common `read.csv()` Options

The `read.csv()` function has several useful parameters:

```{r, eval=FALSE}
# Full path (if file is not in working directory)
my_data = read.csv("C:/Users/YourUsername/Data/myfile.csv")

# If your CSV uses a different separator (e.g., semicolon)
my_data = read.csv("filename.csv", sep = ";")

# If your CSV doesn't have column headers
my_data = read.csv("filename.csv", header = FALSE)

# If you want to keep strings as characters (not factors)
my_data = read.csv("filename.csv", stringsAsFactors = FALSE)

# If you want to skip the first few rows
my_data = read.csv("filename.csv", skip = 2)
```

# Examining a Data Frame

Once you have imported your data, you should always examine it to understand its structure and contents.

## Viewing the Data

```{r}
# View the first 6 rows (default)
head(car_data)
```

```{r}
# View the first 10 rows
head(car_data, 10)
```

```{r}
# View the last 6 rows
tail(car_data)
```

```{r, eval=FALSE}
# Open the data in a spreadsheet-like viewer (in RStudio)
View(car_data)
```

## Dimensions of the Data Frame

```{r}
# Number of rows (observations)
nrow(car_data)
```

```{r}
# Number of columns (variables)
ncol(car_data)
```

```{r}
# Both dimensions at once: rows, columns
dim(car_data)
```

## Column Names

```{r}
# Get all column names
names(car_data)
```

```{r}
# Alternative function for column names
colnames(car_data)
```

## Structure of the Data Frame

The `str()` function provides a compact display of the internal structure of an R object:

```{r}
str(car_data)
```

This shows us the data type of each variable (e.g., `num` for numeric, `int` for integer, `chr` for character).

## Summary of the Data Frame

The `summary()` function provides a statistical summary of each variable:

```{r}
summary(car_data)
```

For numeric variables, `summary()` provides the minimum, 1st quartile, median, mean, 3rd quartile, and maximum. For categorical variables, it shows the frequency of each level.

# Basic Numerical Summaries

R provides many functions for calculating summary statistics on numeric data.

## Measures of Central Tendency

### Mean (Average)

The mean is the sum of all values divided by the number of values.

```{r}
# Mean of miles per gallon
mean(car_data$mpg)
```

### Median

The median is the middle value when data is sorted. It is more robust to outliers than the mean.

```{r}
# Median of miles per gallon
median(car_data$mpg)
```

## Measures of Spread

### Variance and Standard Deviation

```{r}
# Variance
var(car_data$mpg)

# Standard deviation
sd(car_data$mpg)
```

### Range

```{r}
# Minimum value
min(car_data$mpg)

# Maximum value
max(car_data$mpg)

# Range (returns min and max)
range(car_data$mpg)
```

## Quartiles and Percentiles

Quartiles divide the data into four equal parts.

```{r}
# Default quartiles (0%, 25%, 50%, 75%, 100%)
quantile(car_data$mpg)
```

```{r}
# Specific percentiles
quantile(car_data$mpg, probs = c(0.10, 0.25, 0.50, 0.75, 0.90))
```

```{r}
# Interquartile range (Q3 - Q1)
IQR(car_data$mpg)
```

## The Five-Number Summary

The five-number summary consists of the minimum, Q1, median, Q3, and maximum:

```{r}
fivenum(car_data$mpg)
```

| Measurement | Interpretation | Syntax |
|------------------------|------------------------|------------------------|
| Mean (Average, Expected value, Expectation) | A quantity representing the "center" of a collection of numbers, calculated as the sum of the values divided by the number of values. | `mean()` |
| Median | The middle value in an ordered dataset, separating the higher half from the lower half. More resistant to outliers, compared to mean. | `median()` |
| Variance | The expected value of the squared deviation from the mean of a data set. | `var()` |
| Standard Deviation | Is obtained as the square root of the variance. | `sd()` |
| Range | The difference between the maximum value in a data set and its minimum value. | `range()`, however, gives you the minimum value and the maximum value of a data set, not their difference. |
| Quartiles | A *k*-th percentile is a value below which there is a *k*-percent of the population. The first quartile (Q1) is a 25-th percentile. The second quartile (Q2) is a 50-th percentile, and the third quartile (Q3) is a 75-th percentile. | `quantile()` for the first, second and third quartiles; `quantile(,probs = c())` with predetermined percentages for any other percentiles. |
| Interquartile Range (IQR) | The difference between the third quartile (Q3) and the first quartile (Q1). | `IQR()` |
| Five-Number Summary | The five-number summary consists of the minimum, the first quartile (Q1), the second quartile (Q2, or also known as the median), the third quartile (Q3), and maximum. | `fivenum()` |


## Handling Missing Values

When your data contains missing values (`NA`), many summary functions will return `NA` by default. Use the `na.rm = TRUE` argument to remove missing values before calculation:

```{r}
# Create a vector with missing values for demonstration
mpg_with_na = c(car_data$mpg, NA, NA)

# Without na.rm, returns NA
mean(mpg_with_na)

# With na.rm = TRUE, ignores NA values
mean(mpg_with_na, na.rm = TRUE)
```

# Summaries for Categorical Variables

Categorical variables (also called factor variables) represent groups or categories. Let's create a categorical example using the `mtcars` data.

```{r}
# Create a copy with categorical variables
car_data$cyl_factor = factor(car_data$cyl, 
                               labels = c("4-cylinder", "6-cylinder", "8-cylinder"))
car_data$am_factor = factor(car_data$am, 
                              labels = c("Automatic", "Manual"))
```

## Frequency Tables

```{r}
# Count observations in each category
table(car_data$cyl_factor)
```

```{r}
# Two-way frequency table (cross-tabulation)
table(car_data$cyl_factor, car_data$am_factor)
```

## Proportions

```{r}
# Proportion table
prop.table(table(car_data$cyl_factor))
```

```{r}
# Proportions as percentages (rounded to 1 decimal)
round(prop.table(table(car_data$cyl_factor)) * 100, 1)
```

```{r}
# Row proportions for two-way table
prop.table(table(car_data$cyl_factor, car_data$am_factor), margin = 1)
```

```{r}
# Column proportions for two-way table
prop.table(table(car_data$cyl_factor, car_data$am_factor), margin = 2)
```

# Extracting Columns and Rows

## Extracting Columns

There are several ways to extract columns from a data frame.

### Using the `$` Operator

The dollar sign `$` in R is a fundamental subsetting operator used to access and manipulate elements within data frames and lists by their names. This approach is intuitive and enhances code readability compared to other methods like square brackets. One thing to bear in mind is that column names are case-sensitive when using the `$` operator.

```{r eval=FALSE, include=TRUE}
# Extract the mpg column as a vector
car_data$mpg
```

### Using Square Brackets with Column Name

In a data frame `df`, `df[["column_name"]]` extracts the column as a vector, while `df["column_name"]` returns a single-column data frame. 

```{r eval=FALSE, include=TRUE}
# Single brackets return a data frame
car_data["mpg"]
```

```{r eval=FALSE, include=TRUE}
# Double brackets return a vector
car_data[["mpg"]]
```

### Using Square Brackets with Column Index

Besides the two aforementioned techniques, one can also extract a column from a given data frame by using square brackets with the column index.

```{r eval=FALSE, include=TRUE}
# Extract the second column (mpg is in column 2 after X)
car_data[, 2]
```

### Extracting Multiple Columns

Similar to extracting a single column from data frame `df`, one can employ base R square bracket notation to extract multiple columns. Use a vector of column names created with the c() function inside the brackets. The general syntax is `df[, c("col_name1", "col_name2")]` or `df[, c(col_index1, "col_index2")]`.

```{r eval=FALSE, include=TRUE}
# By name
car_data[, c("mpg", "hp", "wt")]
```

```{r eval=FALSE, include=TRUE}
# By index
car_data[, c(2, 5, 7)]
```

## Extracting Rows

### By Index

```{r}
# Extract the first row
car_data[1, ]
```

```{r}
# Extract rows 1 through 5
car_data[1:5, ]
```

```{r}
# Extract specific rows
car_data[c(1, 5, 10), ]
```

### By Condition (Logical Subsetting)

```{r}
# Cars with mpg greater than 25
car_data[car_data$mpg > 25, ]
```

```{r}
# Cars with 6 cylinders
car_data[car_data$cyl == 6, ]
```

```{r}
# Multiple conditions: 6 cylinders AND manual transmission
car_data[car_data$cyl == 6 & car_data$am == 1, ]
```

```{r}
# Multiple conditions: 4 cylinders OR 8 cylinders
car_data[car_data$cyl == 4 | car_data$cyl == 8, ]
```

## Extracting Specific Cells

```{r}
# Row 3, Column 2
car_data[3, 2]
```

```{r}
# Rows 1-3, Columns 2-4
car_data[1:3, 2:4]
```


# References

- Wickham, H., & Grolemund, G. (2017). *R for Data Science*. O'Reilly Media. Available free online at [https://r4ds.had.co.nz/](https://r4ds.had.co.nz/)

```{r cleanup, include=FALSE}
# Clean up the example CSV file
if (file.exists("mtcars_example.csv")) {
  file.remove("mtcars_example.csv")
}
```

